<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>제이씨메디칼(JCMedical)</title>
  <meta name="description" content="제이씨메디칼(JCMedical, JC메디칼) 오스테오시스, 마인드레이 전문 대리점">
  <meta name="keywords" content="제이씨메디칼, JC메디칼, jcmedical, 오스테오시스, 마인드레이, 골밀도, 충격파, 초음파, 심전도, 환자감시모니터, 중고 초음파, 토르리프팅">
  <meta name="robots" content="index, follow">
  <meta property="og:type" content="website">
  <meta property="og:title" content="제이씨메디칼(JCMedical)">
  <meta property="og:description" content="골밀도, 충격파, 초음파, 심전도, 환자감시모니터, 중고 초음파, 토르리프팅">
  <meta property="og:url" content="https://www.jcmedical.com/">
  <meta property="og:image" content="https://www.jcmedical.com/img/logo.png">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "MedicalBusiness",
    "name": "제이씨메디칼 (JCMedical, JC메디칼)",
    "description": "제이씨메디칼(JC메디칼) 오스테오시스, 마인드레이 전문 대리점",
    "url": "https://www.jcmedical.com/",
    "telephone": "010-9474-6127",
    "address": {
      "@type": "PostalAddress",
	  "postalCode": "13647",
	  "addressRegion": "경기",
      "addressLocality": "성남시 수정구",
	  "streetAddress": "위례서로24, 위례행복빌딩3층 303호"
    },
    "keywords": "제이씨메디칼, JC메디칼, jcmedical, 오스테오시스, 마인드레이, 골밀도, 충격파, 초음파, 심전도, 환자감시모니터, 중고 초음파, 토르리프팅"
  }
  </script>
  <meta name="author" content="JCMedical">  
  <link rel="canonical" href="https://www.jcmedical.com/">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/notice.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
  <script src="js/app.js" defer></script>
</head>
  <style>
    .view-container { max-width: 900px; margin: 40px auto; padding: 0 20px; }
    .view-header { border-bottom: 2px solid #2C4349; padding-bottom: 20px; margin-bottom: 30px; }
    .view-header .cat { color: #C5A36A; font-weight: 700; font-size: 14px; display: block; margin-bottom: 10px; }
    .view-header h2 { font-size: 28px; color: #1e293b; line-height: 1.4; margin-bottom: 15px; }
    .view-header .info { font-size: 14px; color: #94a3b8; }
    
    .view-content { min-height: 300px; line-height: 1.8; font-size: 16px; color: #333; }
    /* Quill 이미지 중앙 정렬 및 반응형 */
    .view-content img { max-width: 100%; height: auto; display: block; margin: 20px auto; }

    .view-footer { margin-top: 60px; border-top: 1px solid #eee; padding-top: 30px; display: flex; justify-content: center; gap: 15px; }
    .btn-list { padding: 12px 30px; background: #2C4349; color: #fff; border-radius: 4px; font-weight: 600; }
    
    @media (max-width: 768px) {
        .view-header h2 { font-size: 22px; }
    }
  </style>
<body>
<header>
    <div class="header-inner">
        <a href="index.html" class="logo">
            <img src="img/logo_long.png" alt="JC Medical">
        </a>
        
        <nav class="nav">
            <ul class="nav-menu">
                <li class="nav-item">
					<a href="#">회사소개 <span class="icon-plus">+</span><span class="icon-minus">-</span></a>
					<ul class="mobile-sub">
						<li><a href="about.html">인사말</a></li>
						<li><a href="about.html#location">오시는길</a></li>
					</ul>
				</li>
                <li class="nav-item">
					<a href="#">PRODUCT <span class="icon-plus">+</span><span class="icon-minus">-</span></a>
					<ul class="mobile-sub">
						<li><a href="products.html?cat=bmd">골밀도진단기 (BMD)</a></li>
						<li><a href="products.html?cat=eswt">체외충격파 (ESWT)</a></li>
						<li><a href="products.html?cat=ultrasound">초음파진단기 (Ultrasound / SONO)</a></li>
						<li><a href="products.html?cat=freq">고주파기기 (TORR RF)</a></li>
						<li><a href="products.html?cat=used">중고장비</a></li>
					</ul>
				</li>
                <li class="nav-item">
					<a href="notice.html">공지사항</a>
				</li>
                <li class="nav-item">
					<a href="contact.html">문의하기</a>
				</li>
            </ul>
        </nav>
		
		<div class="partner-logo">
			<div class="vendor-logos">
				<img src="img/os_logo.png" alt="OsteoSys">
				<img src="img/min_logo.png" alt="Mindray">
			</div>
			<a href="http://pf.kakao.com/_pdvjn/chat" target="_blank"><img src="img/kakao.png" alt="kakao"></a>
			<a href="https://blog.naver.com/jcmedical0826" target="_blank"><img src="img/blog.png" alt="naver blog"></a>
		</div>
        
        <div class="hamburger">☰</div>
    </div>

    <div class="mega-menu">
        <div class="mega-inner">
            <div class="mega-col">
                <a href="about.html">인사말</a>
				<a href="about.html#location">오시는길</a>
            </div>
        
            <div class="mega-col">
				<a href="products.html?cat=bmd">골밀도진단기 (BMD)</a>
				<a href="products.html?cat=eswt">체외충격파 (ESWT)</a>
				<a href="products.html?cat=ultrasound">초음파진단기<br>(Ultrasound / SONO)</a>
				<a href="products.html?cat=freq">고주파기기 (TORR RF)</a>
                <a href="products.html?cat=used">중고장비</a>
            </div>
        
            <div class="mega-col">
                <a href="notice.html">공지사항</a>
            </div>
        
            <div class="mega-col">
                <a href="contact.html">문의하기</a>
            </div>
        </div>
    </div>
</header>

<section class="sub-visual">
    <div class="visual-text">
        <h2>NOTICE</h2>
        <p>JC Medical의 끊임없는 도전과 변화, 이곳에서 확인하세요.</p>
    </div>
</section>

    <div class="view-container">
        <div id="loading" style="text-align:center; padding:50px;">로딩 중...</div>
        
        <article id="noticeDetail" style="display:none;">
            <div class="view-header">
                <span class="cat" id="v-category"></span>
                <h2 id="v-title"></h2>
                <div class="info">
                    작성일: <span id="v-date"></span>
                </div>
            </div>

            <div class="view-content ql-editor" id="v-content">
                </div>

            <div class="view-footer">
                <a href="notice.html" class="btn-list">목록으로</a>
                <button id="admin-edit-btn" class="btn-list" style="background:#C5A36A; display:none;" data-admin-only>수정하기</button>
				<button id="deleteBtn" class="btn-list" style="background:#e74c3c; display:none;" data-admin-only>삭제</button>
            </div>
        </article>
    </div>
    <script>
        // URL에서 ID 파라미터 가져오기
        const urlParams = new URLSearchParams(window.location.search);
        const noticeId = urlParams.get('id');

        async function fetchDetail() {
            if (!noticeId) {
                alert('잘못된 접근입니다.');
                location.href = 'notice.html';
                return;
            }

            const { data, error } = await supabaseClient
                .from('notices')
                .select('*')
                .eq('id', noticeId)
                .single();

            if (error || !data) {
                alert('해당 글을 찾을 수 없습니다.');
                location.href = 'notice.html';
                return;
            }

            // 데이터 바인딩
            document.getElementById('v-title').innerText = data.title;
            document.getElementById('v-category').innerText = data.category || '공지사항';
            document.getElementById('v-date').innerText = new Date(data.created_at).toLocaleDateString();
            document.getElementById('v-content').innerHTML = data.content; // Quill HTML

            // 로딩 숨기고 컨텐츠 보이기
            document.getElementById('loading').style.display = 'none';
            document.getElementById('noticeDetail').style.display = 'block';

            // 수정 버튼 처리
            const editBtn = document.getElementById('admin-edit-btn');
            editBtn.onclick = () => location.href = `notice_edit.html?id=${data.id}`;
        }

        window.addEventListener('DOMContentLoaded', fetchDetail);

document.getElementById('deleteBtn').addEventListener('click', async () => {
  if (!confirm('정말 이 공지를 삭제하시겠습니까?')) return;

  try {
    // 1. 공지 데이터 가져오기
    const { data, error } = await supabaseClient
      .from('notices')
      .select('content')
      .eq('id', noticeId)
      .single();

    if (error) throw error;

    // 2. content 안 이미지 URL 추출
    const doc = new DOMParser().parseFromString(data.content, 'text/html');
    const images = [...doc.querySelectorAll('img')];

    // 3. Storage 이미지 전부 삭제
    for (const img of images) {
      const url = img.src;
      const path = url.split('/public/notice_img/')[1];
      if (!path) continue;

      await supabaseClient
        .storage
        .from('notice_img')
        .remove([path]);
    }

    // 4. DB row 삭제
    const { error: deleteError } = await supabaseClient
      .from('notices')
      .delete()
      .eq('id', noticeId);

    if (deleteError) throw deleteError;

    alert('공지와 이미지가 모두 삭제되었습니다.');
    location.href = 'notice.html';

  } catch (err) {
    console.error(err);
    alert('삭제 실패: ' + err.message);
  }
});
</script>

<footer class="site-footer">
  <div class="footer-inner">

    <div class="footer-logo-area">
      <img src="img/logo.png" alt="JC Medical" class="footer-logo">
    </div>
	
	<div class="footer-text-area">
      <p class="footer-info">
        Address: 경기도 성남시 수정구 위례서로24, 위례행복빌딩3층 303호<br>
        Tel: 070-4651-5088 | 010-9474-6127 <br>
        E-mail: jcmedi0826@naver.com<Br>
		사업자번호: 512-13-30045
      </p>
	  
	  <div class="footer-links">
      <a href="policy.html?tab=terms">이용약관</a>
      <span class="divider">|</span>
      <a href="policy.html?tab=privacy">개인정보처리방침</a>
    </div>
    </div>

  </div>

  <div class="footer-bottom">
    © 2025 JC Medical. All rights reserved.
  </div>
</footer>
</body>
</html>